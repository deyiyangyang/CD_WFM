@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="@Url.Content("~/Scripts/Chart.js")" type="text/javascript"></script>
@Html.Partial("DatePickerScript")
<script type="text/javascript">
    $(document).ready(function () {
        $('#txtBaseDate').datepicker(opt_datePicker);
        $('#txtBaseDate').datepicker('setDate', (new Date()).DateAdd('d', -1));
        $('#txtBaseDate').datepicker("option", 'maxDate', (new Date()).DateAdd('d', -1));

        ShowLineChart("IboundCallPredictionChart");
        $("#ActualCall").click(function () {
            ShowLineChart("IboundCallPredictionChart");
        });
        $("#Search").click(function () {
            var vUrl = '@Url.Content("~/CallPrediction/Search_Ajax/")';
            var ctx = $("#IboundCallPredictionChart").get(0).getContext("2d");
            var myChart = new Chart(ctx);
            var options = {
                legendTemplate: "<table class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><tr><td style=\"background-color:<%=datasets[i].strokeColor%>;width:20px\"></td><%if(datasets[i].label){%><td><%=datasets[i].label%></td><%}%></tr><%}%></table>",
                datasetFill: false
            }
            $.ajax({
                url: vUrl,
                data: { txtBaseDate: $("#txtBaseDate").val(), checkType: 1 },
                dataType: "json",
                type: "get",
                beforeSend: function () { $("#msg").html("loading..."); },
                success: function (data) {
                    $("#msg").html("");
                    var lineChart = myChart.Line(response, options);
                }
            });
        });

        function ShowLineChart(element) {
            var options = {
                legendTemplate: "<table class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><tr><td style=\"background-color:<%=datasets[i].strokeColor%>;width:20px\"></td><%if(datasets[i].label){%><td><%=datasets[i].label%></td><%}%></tr><%}%></table>",
                datasetFill: false
            }
            var obj = "#" + element;
            var objLegent = "#" + element + "Legend";
            var ctx = $(obj).get(0).getContext("2d");
            var myChart = new Chart(ctx);
            var url = "@Html.Raw(Url.Action("LineChart"))";
            $.ajax({
                cache: false,
                async: true,
                url: url,
                data: { txtBaseDate: $("#txtBaseDate").val(), ddlShift: $("#ddlShift").val(), Interval: $("#Interval").val() },
                dataType: "json",
                type: "get",

                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.responseText);
                },
                success: function (response) {
                    var lineChart = myChart.Line(response, options);
                    var legend = lineChart.generateLegend();
                    $(objLegent).append(legend);
                }
            });
        }
    });
</script>
<section class="content-header">
    <h1>
        呼量予測
        <small>データ一覧</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="@Url.Content("~/")"><i class="fa fa-home"></i>ホーム</a></li>
        <li class="active"><a href="@Url.Content("~/CallPrediction")">呼量予測</a></li>
    </ol>
</section>
<section class="content">
    <div class="row">
        <table class="table table-bordered">
            <tr>
                <th style="width: 100px;vertical-align: middle;" class="thUpTitle">
                    ベース日付
                </th>
                <td>
                    @Html.TextBox("txtBaseDate", null, new { maxLength = "10", @readonly = "readonly", style = "width:110px;readonly;margin-right:5px;", @class = "form-control" })
                </td>
                <th style="width: 100px;vertical-align: middle;" class="thUpTitle">
                    シフト
                </th>
                <td>
                    @Html.DropDownList("ddlShift", (List<SelectListItem>)ViewData["lstShift"], new { @class = "form-control" })
                </td>
                <th style="width: 100px;vertical-align: middle;" class="thUpTitle">
                    間隔
                </th>
                <td>
                    <select id="Interval" name="Interval">
                        <option value="1">1分</option>
                        <option value="5">5分</option>
                        <option value="10">10分</option>
                        <option value="15">15分</option>
                        <option value="30">30分</option>
                        <option value="60">60分</option>
                    </select>
                </td>
                <td  style="vertical-align:middle;text-align:center;">
                    <button type="button" id="ActualCall" name="Search" class="btn btn-primary" style="width: 100px;"><i class="fa fa-search"></i> 実績</button>
                </td>
            </tr>
            <tr>
                <th class="thUpTitle" style="width: 50px;vertical-align: middle;">予測Type</th>
                <td >
                    <div>
                        <label class="checkbox-inline">
                            <input type="checkbox" id="chkWeekdayType" value="1"> 曜日
                        </label>
                        <label class="checkbox-inline">
                            <input type="checkbox" id="chkHolidayType" value="2"> 休日
                        </label>
                        <label class="checkbox-inline">
                            <input type="checkbox" id="chkPromotionType" value="3"> セールス
                        </label>
                        <label class="checkbox-inline">
                            <input type="checkbox" id="chkCustomType" value="4"> 自由選択
                        </label>
                        
                    </div>
                </td>
                <td rowspan="3" style="vertical-align:middle;text-align:center;">
                    <button type="button" id="Search" name="Search" class="btn btn-primary" style="width: 100px;"><i class="fa fa-search"></i> 予測</button>
                </td>
            </tr>
        </table>
    </div>


    @*<div class="jumbotron">
        <div id="msg"></div>
        <canvas id="IboundCallPredictionChart" width="800" height="300"></canvas>
    </div>*@



 

</section>
<div class=" col-lg-11">
    <canvas id="IboundCallPredictionChart" class=" col-lg-12" style="height:300px"></canvas>
</div>
<div id="IboundCallPredictionChartLegend" class=" col-lg-1"></div>